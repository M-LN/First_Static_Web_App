<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <title>ML Analytics Dashboard</title>
</head>
<body>
  <header class="site-header">
    <div class="container">
      <div class="logo">
        <i class="fas fa-brain"></i>
        <span>ML InsightHub</span>
      </div>
      <nav>
        <ul>
          <li><a href="index.html" class="active"><i class="fas fa-home"></i> Home</a></li>
          <li><a href="about.html"><i class="fas fa-info-circle"></i> About</a></li>
          <li><a href="contact.html"><i class="fas fa-envelope"></i> Contact</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <section class="hero">
    <div class="container">
      <div class="hero-content">
        <h1>ML-Powered Business Analytics</h1>
        <p>Generate comprehensive reports with predictive insights, anomaly detection, and customer segmentation analysis.</p>
        <a href="#report-section" class="btn btn-primary">Generate ML Report</a>
      </div>
      <div class="hero-image">
        <img src="https://cdn.pixabay.com/photo/2018/03/27/21/43/startup-3267505_1280.jpg" alt="Analytics Dashboard">
      </div>
    </div>
  </section>

  <section class="features">
    <div class="container">
      <h2 class="section-title">ML Capabilities</h2>
      <div class="feature-grid">
        <div class="feature-card">
          <div class="feature-icon"><i class="fas fa-chart-line"></i></div>
          <h3>Predictive Analytics</h3>
          <p>View revenue forecasts with confidence intervals based on machine learning models</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon"><i class="fas fa-users"></i></div>
          <h3>Customer Segmentation</h3>
          <p>Visualize ML-based customer clusters to identify key customer groups</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon"><i class="fas fa-exclamation-triangle"></i></div>
          <h3>Anomaly Detection</h3>
          <p>Identify unusual patterns and outliers in your business data automatically</p>
        </div>
        <div class="feature-card">
          <div class="feature-icon"><i class="fas fa-percentage"></i></div>
          <h3>Feature Importance</h3>
          <p>Understand which factors drive your business performance the most</p>
        </div>
      </div>
    </div>
  </section>

  <section id="report-section" class="report-generator">
    <div class="container">
      <h2 class="section-title">ML Report Generator</h2>
      <div class="report-card">
        <div class="report-options">
          <h3><i class="fas fa-robot"></i> ML Report Features</h3>
          <p>Generate a comprehensive ML-powered analysis with a single click. The report includes:</p>
          <ul>
            <li><i class="fas fa-check"></i> 5-month revenue forecast with confidence intervals</li>
            <li><i class="fas fa-check"></i> Customer segmentation with bubble chart visualization</li>
            <li><i class="fas fa-check"></i> Anomaly detection to identify unusual patterns</li>
            <li><i class="fas fa-check"></i> Feature importance analysis of revenue drivers</li>
            <li><i class="fas fa-check"></i> AI-generated recommendations based on the data</li>
          </ul>
        </div>
        <div class="report-actions">
          <button id="generateReportBtn" class="btn btn-primary">
            <i class="fas fa-brain"></i> Generate ML Report
          </button>
          <div id="loadingIndicator">
            <i class="fas fa-spinner fa-spin"></i> Running ML algorithms, please wait...
          </div>
          <div class="report-preview" id="reportPreviewSection">
            <h4>Report Preview</h4>
            <div id="reportPreview" class="preview-container"></div>
            <button id="downloadBtn" class="btn btn-secondary">
              <i class="fas fa-download"></i> Download Full Report
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="testimonials">
    <div class="container">
      <h2 class="section-title">What Our Users Say</h2>
      <div class="testimonial-grid">
        <div class="testimonial-card">
          <div class="testimonial-avatar">
            <img src="https://randomuser.me/api/portraits/women/43.jpg" alt="Jane">
          </div>
          <div class="testimonial-content">
            <p>"The ML-based forecasting has been remarkably accurate. We've been able to predict our revenue within 5% margin of error for the past quarter."</p>
            <div class="testimonial-author">Jane D., Marketing Director</div>
          </div>
        </div>
        <div class="testimonial-card">
          <div class="testimonial-avatar">
            <img src="https://randomuser.me/api/portraits/men/32.jpg" alt="Robert">
          </div>
          <div class="testimonial-content">
            <p>"The anomaly detection identified unusual patterns that we had missed. This allowed us to address issues before they impacted our bottom line."</p>
            <div class="testimonial-author">Robert M., CEO</div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <footer class="site-footer">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-about">
          <h3><i class="fas fa-brain"></i> ML InsightHub</h3>
          <p>Helping businesses leverage machine learning for better decision-making and predictive analytics.</p>
        </div>
        <div class="footer-links">
          <h3>Quick Links</h3>
          <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="about.html">About</a></li>
            <li><a href="contact.html">Contact</a></li>
            <li><a href="#">Privacy Policy</a></li>
          </ul>
        </div>
        <div class="footer-contact">
          <h3>Contact Us</h3>
          <p><i class="fas fa-envelope"></i> info@mlinsighthub.example</p>
          <p><i class="fas fa-phone"></i> +1 (555) 123-4567</p>
          <div class="social-links">
            <a href="#" aria-label="Twitter" title="Follow us on Twitter"><i class="fab fa-twitter"></i></a>
            <a href="#" aria-label="LinkedIn" title="Connect with us on LinkedIn"><i class="fab fa-linkedin"></i></a>
            <a href="#" aria-label="GitHub" title="View our projects on GitHub"><i class="fab fa-github"></i></a>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 ML InsightHub. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script>
    // Initialize hidden elements
    document.addEventListener('DOMContentLoaded', function() {
      const reportPreviewSection = document.getElementById('reportPreviewSection');
      reportPreviewSection.style.display = 'none';
    });
    
    // Report generation functionality
    document.getElementById('generateReportBtn').addEventListener('click', async function() {
      const loadingIndicator = document.getElementById('loadingIndicator');
      const generateBtn = document.getElementById('generateReportBtn');
      const reportPreviewSection = document.getElementById('reportPreviewSection');
      const reportPreview = document.getElementById('reportPreview');
      let htmlContent = '';
      
      // Show loading state
      loadingIndicator.style.display = 'block';
      generateBtn.disabled = true;
      reportPreviewSection.style.display = 'none';
      
      try {
        // Call the Azure Function API
        const response = await fetch('/api/GenerateReport');
        
        if (!response.ok) {
          throw new Error(`Failed to generate report: ${response.statusText}`);
        }
        
        // Get the HTML content
        htmlContent = await response.text();
        
        // Show preview with iframe
        reportPreview.innerHTML = `<iframe srcdoc="${htmlContent.replace(/"/g, '&quot;')}" 
                                        style="width:100%; height:300px; border:1px solid #ddd;"></iframe>`;
        
        // Show preview section
        reportPreviewSection.style.display = 'block';
        
      } catch (error) {
        console.error('Error generating report:', error);
        alert('Failed to generate report: ' + error.message);
      } finally {
        // Reset UI state
        loadingIndicator.style.display = 'none';
        generateBtn.disabled = false;
      }
      
      // Set up download button
      document.getElementById('downloadBtn').onclick = function() {
        if (htmlContent) {
          // Create a Blob with the HTML content
          const blob = new Blob([htmlContent], { type: 'text/html' });
          
          // Create a download link
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = `ml-analytics-report-${new Date().toISOString().slice(0, 10)}.html`;
          
          // Trigger download
          document.body.appendChild(a);
          a.click();
          
          // Clean up
          setTimeout(() => {
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
          }, 100);
        }
      };
    });
  </script>
</body>
</html>